name: Dark Mode Toggle Test
description: Verify dark mode toggle functionality, theme persistence, and toast notifications

setup:
  docker-compose: true
  env:
    BASE_URL: http://localhost:3000

steps:
  - action: navigate
    url: "/"

  - action: wait
    selector: "[data-testid='theme-toggle']"
    timeout: 10000

  - action: screenshot
    name: "initial-light-mode"

  - action: assert
    selector: "[data-testid='theme-toggle']"
    contains: "Dark"

  - action: click
    selector: "[data-testid='theme-toggle']"

  - action: wait
    timeout: 500

  - action: screenshot
    name: "dark-mode-enabled"

  - action: assert
    selector: "[data-testid='theme-toggle']"
    contains: "Light"

  # Verify info toast notification appears on theme toggle
  - action: wait
    selector: "[data-testid='toast-info']"
    timeout: 5000

  - action: assert
    selector: "[data-testid='toast-info']"

  - action: assert
    selector: "[data-testid='toast-message']"
    contains: "Switched to dark mode"

  - action: screenshot
    name: "dark-mode-toast"

  # Close the toast before continuing
  - action: click
    selector: "[data-testid='toast-close-btn']"

  - action: wait
    timeout: 300

  - action: assert
    selector: "h1"
    contains: "Webby Test"

  - action: navigate
    url: "/"

  - action: wait
    selector: "[data-testid='theme-toggle']"
    timeout: 10000

  - action: screenshot
    name: "dark-mode-persisted-after-refresh"

  - action: assert
    selector: "[data-testid='theme-toggle']"
    contains: "Light"

  - action: click
    selector: "[data-testid='theme-toggle']"

  - action: wait
    timeout: 500

  - action: screenshot
    name: "light-mode-restored"

  - action: assert
    selector: "[data-testid='theme-toggle']"
    contains: "Dark"

  # Verify info toast notification appears on theme toggle back to light
  - action: wait
    selector: "[data-testid='toast-info']"
    timeout: 5000

  - action: assert
    selector: "[data-testid='toast-info']"

  - action: assert
    selector: "[data-testid='toast-message']"
    contains: "Switched to light mode"

  - action: screenshot
    name: "light-mode-toast"
